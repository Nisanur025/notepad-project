<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Nisanur">
    <title>notebook</title>
    <link rel="stylesheet" type="text/css" href="notepad.css">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    <!-- FontAwesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

</head>

<body>
    <!-- An editable area to show the effect of the ribbon menu buttons => CANVAS-->
    <div id="canvas" contenteditable="true"></div>

    <!-- Design -->
    <div class="ribbon" id="ribbonEditor">
        <!-- Clipboard Group -->
        <div class="ribbon-group">

            <h6>Clipboard</h6>
            <button class="btn btn-light" id="selectAllBtn"><i class="fa fa-paste"></i> Select All</button>
            <button class="btn btn-light" onclick="clearContent()" id="clearBtn"><i class="fa fa-eraser"></i>
                Clear</button>

            <!-- Highlight button -->
            <div class="dropdown-group">
                <button id="highlightBtn"><i class="fa fa-highlighter"></i> Highlight</button>
                <div class="dropdown" id="highlightMenu">
                    <div style="background: yellow;" data-color="yellow"></div>
                    <div style="background: lightgreen;" data-color="lightgreen"></div>
                    <div style="background: pink;" data-color="pink"></div>
                    <div class="clearOption" data-color="transparent"><i class="bi bi-x"></i></div>
                </div>
            </div>

        </div>

        <!-- Font Group -->
        <div class="ribbon-group">

            <h6>Font</h6>
            <select class="form-select form-select-sm" id="fontFamily">
                <option selected value="">Font Family</option>
                <option value="Arial">Arial</option>
                <option value="Times New Roman">Times New Roman</option>
                <option value="Calibri">Calibri</option>
                <option value="Verdana">Verdana</option>
            </select>

            <select class="form-select form-select-sm" id="fontSizeSelect">
                <option selected>Font Size</option>
                <option value="1">10</option>
                <option value="2">11</option>
                <option value="3">12</option>
                <option value="4">14</option>
                <option value="5">16</option>
                <option value="6">18</option>
            </select>
            <button id="italicBtn" class="btn btn-light" data-command="bold"><i class="fa fa-bold"></i></button>
            <button class="btn btn-light" data-command="italic"><i class="fa fa-italic"></i></button>
            <button class="btn btn-light" data-command="underline"><i class="fa fa-underline"></i></button>

            <!-- Font color button -->
            <div class="dropdown-group">
                <button id="fontColorBtn"><i class="fa fa-paint-brush"></i> Text Color</button>
                <div class="dropdown" id="fontColorMenu">
                    <div style="background: red;" data-color="red"></div>
                    <div style="background: blue;" data-color="blue"></div>
                    <div style="background: purple;" data-color="purple"></div>
                    <div style="background: black;" data-color="black"></div>
                </div>
            </div>

        </div>

        <!-- Paragraph Group -->
        <div class="ribbon-group">
            <h6>Paragraph</h6>
            <button class="btn btn-light" data-command="insertUnorderedList"><i class="fa fa-list-ul"></i></button>
            <button class="btn btn-light" data-command="insertOrderedList"><i class="fa fa-list-ol"></i></button>
            <button class="btn btn-light" data-command="indent"><i class="fa fa-indent"></i></button>
            <button class="btn btn-light" data-command="outdent"><i class="fa fa-outdent"></i></button>
            <button class="btn btn-light" data-command="justifyLeft"><i class="fa fa-align-left"></i></button>
            <button class="btn btn-light" data-command="justifyCenter"><i class="fa fa-align-center"></i></button>
            <button class="btn btn-light" data-command="justifyRight"><i class="fa fa-align-right"></i></button>
        </div>

        <!-- Search Group -->
        <div class="ribbon-group">
            <h6>Search</h6>
            <button class="btn btn-light" id="findBtn"><i class="fa fa-search"></i> Find</button>
            <button class="btn btn-light" id="replaceBtn"><i class="fa fa-exchange-alt"></i> Replace</button>
            <button class="btn btn-light" id="createBtn"><i class="bi bi-plus-lg"></i> Create</button>
            <button class="btn btn-light" id="downloadBtn" onclick="saveText()"><i class="bi bi-plus-lg"></i>
                Download</button>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Create button
        document.getElementById("createBtn").addEventListener("click", function () {
            document.getElementById("canvas").style.display = "block"; /* Show editor when button is clicked*/
            this.style.display = "none"; // Hide the Create Button
            document.getElementById("downloadBtn").style.display = "block"; // Show the Download
        });

        //is the button selected?
        const editor = document.getElementById("ribbonEditor");

        // All buttons in ribbon-group
        const ribbonButtons = document.querySelectorAll(".ribbon-group button");

        // Font-Bold-Italic-alignment
        ribbonButtons.forEach(btn => {
            btn.addEventListener("click", function () {
                // Get the button's data-command attribute (example: bold, italic)
                const command = this.dataset.command;
                if (command) {
                    // Apply style
                    document.execCommand(command, false, null);
                    if (["bold", "italic", "underline"].includes(command)) {
                        if (document.queryCommandState(command)) {
                            this.classList.add("active");
                        } else {
                            this.classList.remove("active");
                        }
                    }
                    //alignment
                    else if (["justifyLeft", "justifyCenter", "justifyRight", "justifyFull"].includes(command)) {

                        document.querySelectorAll("[data-command^='justify']").forEach(b => b.classList.remove("active"));
                        const currentAlign = document.queryCommandValue("justify");

                        // select the button that fits that alignment
                        const activeBtn = document.querySelector(
                            `[data-command="justify${currentAlign.charAt(0).toUpperCase() + currentAlign.slice(1)}"]`
                        );
                        if (activeBtn) activeBtn.classList.add("active");
                    }
                }
            });
        });

        //Font-size
        const fontSizeSelect = document.getElementById("fontSizeSelect");
        fontSizeSelect.addEventListener("click", function () {
            const size = this.value;
            document.execCommand("fontsize", false, size);
        });

        // font-family
        const fontFamily = document.getElementById("fontFamily");
        fontFamily.addEventListener("change", function () {
            const family = this.value;
            if (family) {
                document.execCommand("fontName", false, family);
            }
        });

        // Search Group
        document.addEventListener("DOMContentLoaded", function () {
            const canvas = document.getElementById("canvas");
            const findBtn = document.getElementById("findBtn");
            const replaceBtn = document.getElementById("replaceBtn");

            findBtn.addEventListener("click", function () {
                const textToFind = prompt("Type the word you want to search for:").trim();
                if (!textToFind) return;

                const content = canvas.innerText || canvas.textContent;

                if (content.toLowerCase().includes(textToFind.toLowerCase())) {
                    alert(`"${textToFind}" found!`);
                } else {
                    alert(`"${textToFind}"not found!`);
                }
            });

            //Replace buton
            replaceBtn.addEventListener("click", function () {
                const findText = prompt("Type the word you want to change:").trim();
                if (!findText) return;

                const replaceText = prompt(`"${findText}" which word should replace it?`).trim();
                if (replaceText === null) return;

                const content = canvas.innerHTML;
                const regex = new RegExp(findText, "gi"); // case insensitive
                if (regex.test(content)) {
                    canvas.innerHTML = content.replace(regex, replaceText);
                    alert(`"The word ${findText}" has been replaced with "${replaceText}"`);
                } else {
                    alert(`"${findText}"not found!`);
                }
            });
        });

        // Download content with .html extension
        function saveText() {
            const content = document.getElementById("canvas").innerHTML;
            // Get file name from user
            let fileName = prompt("Enter the File Name : ", "content.html");
            if (!fileName) fileName = "content.html";

            // Create and download blob
            const blob = new Blob([content], { type: "text/html" });
            const link = document.createElement("a");
            link.href = URL.createObjectURL(blob);
            link.download = fileName;
            link.click();
        }

        //Clear Button
        function clearContent() {
            document.getElementById("canvas").innerHTML = ' ';
            document.getElementById("canvas").style.display = "none";
            document.getElementById("downloadBtn").style.display = "none";
            document.getElementById("createBtn").style.display = "inline-block";
        }

        // Select All Button
        document.getElementById("selectAllBtn").addEventListener("click", () => {
            const range = document.createRange();
            range.selectNodeContents(canvas);
            const sel = window.getSelection();
            sel.removeAllRanges();
            sel.addRange(range);
        });

        //highligt and Font color
        const highlightBtn = document.getElementById("highlightBtn");
        const highlightMenu = document.getElementById("highlightMenu");
        const fontColorBtn = document.getElementById("fontColorBtn");
        const fontColorMenu = document.getElementById("fontColorMenu");

        // Dropdown open/close
        function toggleMenu(btn, menu) {
            btn.addEventListener("click", () => {
                menu.style.display = (menu.style.display === "block") ? "none" : "block";
            });
        }

        toggleMenu(highlightBtn, highlightMenu);
        toggleMenu(fontColorBtn, fontColorMenu);

        // Color Selection
        function applyColor(menu, command) {
            menu.querySelectorAll("div").forEach(option => {
                option.addEventListener("mousedown", e => {
                    e.preventDefault(); // Don't let the choice be lost
                    const color = option.dataset.color;
                    document.execCommand(command, false, color);
                    menu.style.display = "none";
                });
            });
        }

        // Highlight (background color of the text)
        applyColor(highlightMenu, "hiliteColor");

        // Text color
        applyColor(fontColorMenu, "foreColor");

    </script>
</body>

</html>